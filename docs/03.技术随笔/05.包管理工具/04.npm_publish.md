---
title: å¦‚ä½•å°†è‡ªå·±çš„packageå‘å¸ƒåˆ°npmå®˜æ–¹ä»“åº“
date: 2022-02-17 21:38:23
permalink: /pages/122235/
categories:
  - æŠ€æœ¯éšç¬”
  - åŒ…ç®¡ç†å·¥å…·
tags:
  - npm
---



## 0.å‰è¨€

æœ¬ç¯‡åšå®¢ä¸»è¦è®²è§£çš„æ˜¯å¦‚ä½•å°†è‡ªå·±å†™çš„`module`å‘å¸ƒåˆ°`npm`çš„å®˜æ–¹ä»“åº“ä¸Šã€‚



## 1.å…·ä½“æ­¥éª¤

### å‡†å¤‡å·¥ä½œï¼šä¸€ä¸ªè´¦å·

åœ¨å‘å¸ƒå…¬å…± package ä¹‹å‰ï¼Œéœ€è¦åœ¨ [npm å®˜ç½‘](https://www.npmjs.com/)è¿›è¡Œæ³¨å†Œä¸€ä¸ªè´¦å·ã€‚

éšåï¼Œåœ¨æœ¬åœ°(éœ€è¦å‘åŒ…çš„åœ°æ–¹)æ‰§è¡Œå‘½ä»¤ `npm login`ï¼Œè¿›è¡Œäº¤äº’å¼æ“ä½œå¹¶ä¸”ç™»å½•ã€‚

```
$ npm login
```

### å‘åŒ…

å‘å¸ƒä¸€ä¸ª npm åŒ…ä¹‹å‰ï¼Œå¡«å†™ `package.json` ä¸­ä»¥ä¸‹ä¸‰é¡¹æœ€é‡è¦çš„å­—æ®µã€‚å‡è®¾æ­¤æ—¶åŒ…çš„åç§°ä¸º `@shanyue/just-demo`

```json
{
  name: '@shanyue/just-demo',
  version: '1.0.0',
  main: './index.js',
}
```

ä¹‹åæ‰§è¡Œ `npm publish` å‘åŒ…å³å¯ã€‚

```shell
$ npm publish
```

ä¸€æ—¦å‘å¸ƒå®Œæˆï¼Œåœ¨ä»»æ„åœ°æ–¹é€šè¿‡ `npm i` å‡å¯ä¾èµ–è¯¥åŒ…ã€‚

```javascript
const x = require('@shanyue/just-demo')

console.log(x)
```

å¦‚è‹¥è¯¥åŒ…è¿›è¡Œæ›´æ–°åï¼Œéœ€è¦å†æ¬¡å‘åŒ…ï¼Œå¯ `npm version` æ§åˆ¶è¯¥ç‰ˆæœ¬è¿›è¡Œå‡çº§ï¼Œè®°ä½éœ€è¦éµå®ˆ [Semver è§„èŒƒ](https://github.com/shfshanyue/Daily-Question/issues/534)

```shell
# å¢åŠ ä¸€ä¸ªä¿®å¤ç‰ˆæœ¬å·: 1.0.1 -> 1.0.2 (è‡ªåŠ¨æ›´æ”¹ package.json ä¸­çš„ version å­—æ®µ)
$ npm version patch

# å¢åŠ ä¸€ä¸ªå°çš„ç‰ˆæœ¬å·: 1.0.1 -> 1.1.0 (è‡ªåŠ¨æ›´æ”¹ package.json ä¸­çš„ version å­—æ®µ)
$ npm version minor

# å°†æ›´æ–°åçš„åŒ…å‘å¸ƒåˆ° npm ä¸­
$ npm publish
```

### å®é™…å‘åŒ…çš„å†…å®¹

åœ¨ npm å‘åŒ…æ—¶ï¼Œå®é™…å‘åŒ…å†…å®¹ä¸º `package.json` ä¸­ `files` å­—æ®µï¼Œä¸€èˆ¬åªéœ€å°†æ„å»ºåèµ„æº(å¦‚æœéœ€è¦æ„å»º)è¿›è¡Œå‘åŒ…ï¼Œæºæ–‡ä»¶å¯å‘å¯ä¸å‘ã€‚

```
{
  files: ['dist']
}
```

è‹¥éœ€è¦æŸ¥çœ‹ä¸€ä¸ª package çš„å‘åŒ…å†…å®¹ï¼Œå¯ç›´æ¥åœ¨ `node_modules/${package}` è¿›è¡ŒæŸ¥çœ‹ï¼Œå°†ä¼šå‘ç°å®ƒå’Œæºç æœ‰å¾ˆå¤§ä¸åŒã€‚ä¹Ÿå¯ä»¥åœ¨ CDN ä¸­è¿›è¡ŒæŸ¥çœ‹ï¼Œä»¥ React ä¸ºä¾‹

1. jsdelivr: https://cdn.jsdelivr.net/npm/react/
2. unpkg: https://unpkg.com/browse/react/

![](https://wjs-tik.oss-cn-shanghai.aliyuncs.com/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f7368667368616e7975652f6173736574732f323032312d31312d32372f636c6970626f6172642d373234382e3466383234312e77656270.webp)



### å‘åŒ…çš„å®é™…æµç¨‹

`npm publish` å°†è‡ªåŠ¨èµ°è¿‡ä»¥ä¸‹ç”Ÿå‘½å‘¨æœŸ

- `prepublishOnly`: å¦‚æœå‘åŒ…ä¹‹å‰éœ€è¦æ„å»ºï¼Œå¯ä»¥æ”¾åœ¨è¿™é‡Œæ‰§è¡Œ
- `prepack`
- `prepare`: å¦‚æœå‘åŒ…ä¹‹å‰éœ€è¦æ„å»ºï¼Œå¯ä»¥æ”¾åœ¨è¿™é‡Œæ‰§è¡Œ (è¯¥å‘¨æœŸä¹Ÿä¼šåœ¨ npm i åè‡ªåŠ¨æ‰§è¡Œ)
- `postpack`
- `publish`
- `postpublish`

å‘åŒ…å®é™…ä¸Šæ˜¯å°†æœ¬åœ° `package` ä¸­çš„æ‰€æœ‰èµ„æºè¿›è¡Œæ‰“åŒ…ï¼Œå¹¶ä¸Šä¼ åˆ° `npm` çš„ä¸€ä¸ªè¿‡ç¨‹ã€‚ä½ å¯ä»¥é€šè¿‡ `npm pack` å‘½ä»¤æŸ¥çœ‹è¯¦æƒ…

```
$ npm pack
npm notice
npm notice ğŸ“¦  midash@0.2.6
npm notice === Tarball Contents ===
npm notice 1.1kB  LICENSE
npm notice 812B   README.md
npm notice 5.7kB  dist/midash.cjs.development.js
npm notice 13.4kB dist/midash.cjs.development.js.map
npm notice 3.2kB  dist/midash.cjs.production.min.js
npm notice 10.5kB dist/midash.cjs.production.min.js.map
npm notice 5.3kB  dist/midash.esm.js
npm notice 13.4kB dist/midash.esm.js.map
npm notice 176B   dist/omit.d.ts
......
npm notice === Tarball Details ===
npm notice name:          midash
npm notice version:       0.2.6
npm notice filename:      midash-0.2.6.tgz
npm notice package size:  11.5 kB
npm notice unpacked size: 67.8 kB
npm notice shasum:        c89d8c1aa96f78ce8b1dcf8f0f058fa7a6936a6a
npm notice integrity:     sha512-lyx8khPVkCHvH[...]kBL6K6VqOG6dQ==
npm notice total files:   46
npm notice
midash-0.2.6.tgz
```

å½“ä½ å‘åŒ…æˆåŠŸåï¼Œä¹Ÿå¯ä»¥å‰å¾€ [npm devtool](https://npm.devtool.tech/react) æŸ¥çœ‹å„é¡¹æ•°æ®ã€‚

![img](https://camo.githubusercontent.com/fbd2cc6c5c1a94d792ac1b26a9e439107990c252f7d3724a0c025596cb15270e/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f7368667368616e7975652f6173736574732f323032312d31312d32372f636c6970626f6172642d383733352e3965373632382e77656270)



