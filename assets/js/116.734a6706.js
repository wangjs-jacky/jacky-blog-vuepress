(window.webpackJsonp=window.webpackJsonp||[]).push([[116],{517:function(s,t,a){"use strict";a.r(t);var n=a(19),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"_0-前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0-前言"}},[s._v("#")]),s._v(" 0.前言")]),s._v(" "),a("p",[s._v("本篇博客记录的是"),a("code",[s._v("VSCode")]),s._v("插件的国际化("),a("code",[s._v("i18n")]),s._v(")功能。")]),s._v(" "),a("p",[s._v("由于国际化在 "),a("code",[s._v("VSCode")]),s._v(" 插件官网仅给了一个案例 "),a("a",{attrs:{href:"https://github.com/microsoft/vscode-extension-samples/tree/main/i18n-sample",target:"_blank",rel:"noopener noreferrer"}},[s._v("i18n-sample"),a("OutboundLink")],1),s._v("，除此以外就无额外说明，因此本篇博客还是具有一定的意义的。")]),s._v(" "),a("h2",{attrs:{id:"_1-国际化能力。"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-国际化能力。"}},[s._v("#")]),s._v(" 1.国际化能力。")]),s._v(" "),a("p",[s._v("国际化共分为三个部分：")]),s._v(" "),a("ol",[a("li",[s._v("组件国际化：页面随 "),a("code",[s._v("Display Language")]),s._v(" 的变化而改变。")]),s._v(" "),a("li",[a("code",[s._v("VSCode")]),s._v(" 界面(指令)国际化。")]),s._v(" "),a("li",[a("code",[s._v("extension")]),s._v(" 插件国际化，如 弹窗提示内容、"),a("code",[s._v("title")]),s._v("、"),a("code",[s._v("command")]),s._v(" 等信息都是由编写在代码中的，更改语言后也需要进行变化。")])]),s._v(" "),a("p",[s._v("由于能力有限，目前仅实现后两者的能力，而组件国际化暂未涉及。")]),s._v(" "),a("h2",{attrs:{id:"_2-工具说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-工具说明"}},[s._v("#")]),s._v(" 2.工具说明")]),s._v(" "),a("p",[s._v("在国际化改造能力中，需要用到以下插件：")]),s._v(" "),a("ol",[a("li",[a("code",[s._v("gulp")]),s._v("：作用同 "),a("code",[s._v("webpack")]),s._v("，通过在 "),a("code",[s._v("gulpfile")]),s._v(" 文件中编写 "),a("code",[s._v("task")]),s._v(" ，实现对代码的处理。")]),s._v(" "),a("li",[a("code",[s._v("vscode-nls")]),s._v("：插件国际化的生产依赖。")]),s._v(" "),a("li",[a("code",[s._v("vscode-nls-dev")]),s._v("："),a("code",[s._v("devDependencies")]),s._v(" 开发依赖，主要用于自动生成"),a("code",[s._v("package.nls.json")]),s._v("、"),a("code",[s._v("package.nls.[language].json")]),s._v("等文件的自动构建。")])]),s._v(" "),a("h2",{attrs:{id:"_3-vscode界面-指令-国际化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-vscode界面-指令-国际化"}},[s._v("#")]),s._v(" 3. "),a("code",[s._v("VSCode")]),s._v("界面(指令)国际化")]),s._v(" "),a("p",[a("code",[s._v("VSCode")]),s._v(" 界面的国际化功能的实现非常简单，但由于官方通过 "),a("code",[s._v("gulp")]),s._v(" 脚本自动生成 "),a("code",[s._v("package.nls.[language].json")]),s._v(" 文件，导致刚开始看的时候没有方向。")]),s._v(" "),a("p",[s._v("以官方 "),a("code",[s._v("i18n-sample")]),s._v("案例为例，实现 "),a("code",[s._v("command")]),s._v(" 的国际化")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("修改 "),a("code",[s._v("package.json")]),s._v(" 将需要国际化的部分用"),a("code",[s._v("%variable%")]),s._v(" 方式包裹。")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"contributes"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"commands"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"command"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"extension.sayHello"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"title"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%extension.sayHello.title%"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"command"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"extension.sayBye"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"title"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%extension.sayBye.title%"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("以上变量读取 "),a("code",[s._v("pacakgae.nls.json")]),s._v(" 中的变量")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"extension.sayHello.title"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sayHello"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"extension.sayBye.title"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sayBye"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("再创建目标语言的 "),a("code",[s._v("package.nls.[language].json")]),s._v(" 文件，如 "),a("code",[s._v("zh-cn")])]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"extension.sayHello.title"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"你好"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"extension.sayBye.title"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"再见"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])])]),s._v(" "),a("h2",{attrs:{id:"_4-插件国际化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-插件国际化"}},[s._v("#")]),s._v(" 4. 插件国际化")]),s._v(" "),a("p",[s._v("这部分修改的是在编写插件代码中，需要替换掉的一些提示信息或标识信息，如：")]),s._v(" "),a("ol",[a("li",[a("code",[s._v("webview")]),s._v(" 的 "),a("code",[s._v("title")])]),s._v(" "),a("li",[a("code",[s._v("showInformationMessage(message)")]),s._v(" 中的弹窗提示信息等。")])]),s._v(" "),a("p",[s._v("而这部分实现，主要依赖于 "),a("code",[s._v("vscode-nls")]),s._v(" 这一生产 依赖实现（在"),a("code",[s._v("package.json")]),s._v("中请严格区分生成和开发依赖，否则插件无法生效）。")]),s._v(" "),a("h3",{attrs:{id:"_4-1-vscode-nls的基础使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-vscode-nls的基础使用"}},[s._v("#")]),s._v(" 4.1.vscode-nls的基础使用")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("从"),a("code",[s._v("vscode-nls")]),s._v("中导出"),a("code",[s._v("nls")])]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" nls "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vscode-nls"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// commonJS 写法")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("生成"),a("code",[s._v("localize")]),s._v(" 函数")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 方式1：其中对 nls.config 的设置没有任何说明。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" localize "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" nls"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("config")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" messageFormat"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" nls"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("MessageFormat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("file "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 方式2：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" localize "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" nls"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("loadMessageBundle")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("传入 "),a("code",[s._v("key")]),s._v(" 和 "),a("code",[s._v("text")]),s._v("，"),a("code",[s._v("message")]),s._v(" 则会根据不同的语言环境对文字进行切换。")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" message "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("localize")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sayHello.text'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Hello'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("如果不是用"),a("code",[s._v("vscode-nls-dev")]),s._v("+"),a("code",[s._v("gulp")]),s._v("的话，则需要在"),a("code",[s._v("out")]),s._v("目录下手动创建以下文件：")]),s._v(" "),a("p",[a("code",[s._v("extension.nls.json")]),s._v("：")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hello"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("code",[s._v("extension.nls.ja.map")]),s._v("：")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"こんにちは"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("code",[s._v("extension.nls.metadata.json")])]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"messages"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hello"')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"keys"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sayHello.text"')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filePath"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"extension"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])])])]),s._v(" "),a("h3",{attrs:{id:"_4-2-i18n-example-案例说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-i18n-example-案例说明"}},[s._v("#")]),s._v(" 4.2 "),a("code",[s._v("i18n-example")]),s._v(" 案例说明")]),s._v(" "),a("p",[s._v("上述情况只是对"),a("code",[s._v("extension")]),s._v("文件中存在国际化改造需求时，当案例中存在导入文件的国际化修改需求时，如"),a("code",[s._v("sayByeCommand")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" nls "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'vscode-nls'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" sayByeCommand "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./command/sayBye'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("activate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("context"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" vscode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ExtensionContext")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 4.1 案例中的一般情况")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" helloCmd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" vscode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("commands"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("registerCommand")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'extension.sayHello'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" message "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("localize")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sayHello.text'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Hello'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\tvscode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("showInformationMessage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 4.2 当 command 是由外部导入的情况")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" byeCmd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" vscode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("commands"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("registerCommand")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'extension.sayBye'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sayByeCommand"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\tcontext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("subscriptions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("helloCmd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" byeCmd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("对于外部导入的文件("),a("code",[s._v("sayBye.js")]),s._v(")，也需要构造"),a("code",[s._v("nls.zh-cn")]),s._v("以及"),a("code",[s._v("nls.metadata")]),s._v("等文件，构建后的代码如下图所示：")]),s._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://wjs-tik.oss-cn-shanghai.aliyuncs.com/image-20220328150533320.png",alt:"image-20220328150533320"}}),s._v(" "),a("h2",{attrs:{id:"_5-高级-使用-gulp-vscode-nls-dev自动创建文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-高级-使用-gulp-vscode-nls-dev自动创建文件"}},[s._v("#")]),s._v(" 5.[高级] 使用 "),a("code",[s._v("gulp")]),s._v("+"),a("code",[s._v("vscode-nls-dev")]),s._v("自动创建文件")]),s._v(" "),a("h3",{attrs:{id:"_5-1-gulp-的基础使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-gulp-的基础使用"}},[s._v("#")]),s._v(" 5.1 gulp 的基础使用")]),s._v(" "),a("p",[s._v("此部分内容，已在"),a("a",{attrs:{href:"https://wjsheng_jacky.gitee.io/vblog/pages/349c25/",target:"_blank",rel:"noopener noreferrer"}},[s._v("《VSCode插件-国际化改造之gulp》"),a("OutboundLink")],1),s._v(" "),a("code",[s._v("gulp")]),s._v(" 简易教程。")]),s._v(" "),a("h3",{attrs:{id:"_5-2-gulpfile-脚本解读"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-gulpfile-脚本解读"}},[s._v("#")]),s._v(" 5.2 gulpfile 脚本解读")]),s._v(" "),a("p",[s._v("在 "),a("code",[s._v("i18n-example")]),s._v(" 案例中 "),a("code",[s._v("gulp")]),s._v(" 脚本主要使用到了如下工具：")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("gulp-sourcemaps")]),s._v("：用于生成 "),a("code",[s._v("sourcemap")])]),s._v(" "),a("p",[a("code",[s._v("sourcemaps.init()")])]),s._v(" "),a("p",[a("code",[s._v("sourcemaps.write(,options)")])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("del")]),s._v("：用于删除数据")]),s._v(" "),a("p",[s._v("与 "),a("code",[s._v("cleanTask")]),s._v(" 绑定在一起，"),a("code",[s._v("del(['out/**', 'package.nls.*.json', 'i18n-sample*.vsix']);")])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("event-stream")]),s._v(" : 事件流")]),s._v(" "),a("p",[s._v("使用："),a("code",[s._v("es.through()")]),s._v(" 在"),a("code",[s._v("node")]),s._v(" 中数据以 "),a("code",[s._v("流")]),s._v(" 的形式传递。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("vscode-nls-dev")]),s._v("：国际化函数。")]),s._v(" "),a("p",[a("code",[s._v("nls.rewriteLocalizeCalls")]),s._v("：生成了"),a("code",[s._v("extension.nls.json")]),s._v(" 以及元数据"),a("code",[s._v("extension.nls.metadata.json")])]),s._v(" "),a("p",[a("code",[s._v("nls.createAdditionalLanguageFiles")]),s._v("：就是基于"),a("code",[s._v("extension.nls.json")]),s._v(" 生成"),a("code",[s._v("extension.nls.ja.json")])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("typescript")]),s._v("+"),a("code",[s._v("gulp-typescript")]),s._v("(ts)：将代码转化为"),a("code",[s._v("js")]),s._v(" 代码")]),s._v(" "),a("ol",[a("li",[s._v("读配置文件并创建"),a("code",[s._v("ts")]),s._v("工程："),a("code",[s._v('tsProject = ts.createProject("./tsconfig.json")')])]),s._v(" "),a("li",[s._v("转化为"),a("code",[s._v("js")]),s._v("代码："),a("code",[s._v('tsProject.src("文件").pipe(tsProject()).js')])])])])]),s._v(" "),a("h3",{attrs:{id:"_5-3-task"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-task"}},[s._v("#")]),s._v(" 5.3 Task")]),s._v(" "),a("p",[s._v("由于 "),a("code",[s._v("gulpfile")]),s._v(" 中的"),a("code",[s._v("task")]),s._v(" 任务很多，核心的就"),a("code",[s._v("buildTask")]),s._v("、"),a("code",[s._v("package")]),s._v("、"),a("code",[s._v("clean")])]),s._v(" "),a("p",[a("code",[s._v("buildTask")]),s._v("：同步执行三个任务："),a("code",[s._v("cleanTask")]),s._v(", "),a("code",[s._v("internalNlsCompileTask")]),s._v(", "),a("code",[s._v("addI18nTask")])]),s._v(" "),a("ol",[a("li",[a("p",[s._v("清空任务，清空 "),a("code",[s._v("out")]),s._v("所有文件，"),a("code",[s._v("package.nls.*.json")]),s._v("（日文），"),a("code",[s._v(".vsix")]),s._v("文件。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("internalNlsCompileTask")]),s._v("：国际化编译任务。")]),s._v(" "),a("p",[s._v("该函数接受 "),a("code",[s._v("true")]),s._v("、"),a("code",[s._v("false")]),s._v(" 布尔值类型，如果是"),a("code",[s._v("true")]),s._v("，则在管道中顺序执行"),a("code",[s._v("nls.rewrietLocalizeCalls()")]),s._v("以及"),a("code",[s._v("nls.createAdditionalLanguageFile")]),s._v("，可以自动创建第"),a("code",[s._v("4")]),s._v("章节所需文件。")]),s._v(" "),a("blockquote",[a("p",[s._v("代码角度：由此也可以看出 "),a("code",[s._v("es.though()")]),s._v(" 的目标就是为了管道流继续往下流，并将上述结果分别写入"),a("code",[s._v("sourceMap")]),s._v("文件中，并且输出在"),a("code",[s._v("outDest")]),s._v("。")])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("addI18nTask")]),s._v("：也是国际化内容，自动创建根目录的 "),a("code",[s._v("package.nls.[language].json")]),s._v(" 文件。")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("读取"),a("code",[s._v("package.nls.json")]),s._v("。")])]),s._v(" "),a("li",[a("p",[s._v("读取"),a("code",[s._v("i18n/jpn")]),s._v("文件夹下的"),a("code",[s._v("package.i18n.json")]),s._v("文件")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" languages "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" folderName"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'zh-cn'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'zh-cn'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("addI18nTask")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" gulp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("src")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'package.nls.json'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("nls"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("createAdditionalLanguageFiles")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("languages"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'i18n'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 读取 i18n/zh-cn 下的 package.i18n.json 文件")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("gulp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("dest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])])])])])]),s._v(" "),a("h2",{attrs:{id:"bug记录-升级插件时遇到的一个坑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bug记录-升级插件时遇到的一个坑"}},[s._v("#")]),s._v(" BUG记录：升级插件时遇到的一个坑")]),s._v(" "),a("p",[s._v("由于插件国际化按照"),a("code",[s._v("i18n-example")]),s._v("教程中，只能通过打包后才能进行测试。")]),s._v(" "),a("p",[s._v("在原有的 "),a("code",[s._v("package.json")]),s._v(" 中存在以下脚本：")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"vscode:prepublish"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yarn run compile"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"compile"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tsc -p ./"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("即，存在一个生命周期函数：在执行"),a("code",[s._v("vsce package")]),s._v("时触发，会预先进行 "),a("code",[s._v("prepublish")]),s._v(" 触发。")]),s._v(" "),a("p",[s._v("具体实现的目的：将 "),a("code",[s._v("ts")]),s._v(" 文件进行打包操作。")]),s._v(" "),a("p",[s._v("由于在插件国际化改造过程中，已经通过"),a("code",[s._v("gulp-typescript")]),s._v("对"),a("code",[s._v("ts")]),s._v("代码进行转化了，并且在此基础上还增加了国际化功能，此生命周期函数会直接覆盖掉之前的操作，从而始终无法看到国际化效果。")]),s._v(" "),a("h2",{attrs:{id:"调试技巧记录-如何调试-gulp-文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#调试技巧记录-如何调试-gulp-文件"}},[s._v("#")]),s._v(" 调试技巧记录：如何调试 "),a("code",[s._v("gulp")]),s._v(" 文件？")]),s._v(" "),a("p",[s._v("在缺少官方文档的情况下，如何调试 "),a("code",[s._v("vscode-nls-dev")]),s._v(" 各"),a("code",[s._v("API")]),s._v("功能？")]),s._v(" "),a("p",[a("code",[s._v("vscode-nls-dev")]),s._v(" 的 "),a("code",[s._v("API")]),s._v(" ：")]),s._v(" "),a("ol",[a("li",[a("code",[s._v("nls.createAdditionalLanguageFiles()")])]),s._v(" "),a("li",[a("code",[s._v("nls.rewriteLocalizeCalls()")])])]),s._v(" "),a("p",[s._v("在以下脚本中，通过添加 "),a("code",[s._v("gulp.dest()")]),s._v(" 代码可以将各个环节的流结果输出到指定目录中。")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("doCompile")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("buildNls")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" r "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tsProject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("src")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sourcemaps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// +.pipe(gulp.dest("./folder1")) ')]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tsProject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// +.pipe(gulp.dest("./folder2")) ')]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("buildNls "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" nls"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rewriteLocalizeCalls")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" es"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("through")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// +.pipe(gulp.dest("./folder3")) ')]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pipe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("buildNls "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" nls"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("createAdditionalLanguageFiles")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("languages"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'i18n'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'out'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" es"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("through")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// +.pipe(gulp.dest("./folder4")) ')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("如通过打印 "),a("code",[s._v("nls.createAdditionalLanguageFile")]),s._v(" 的输出结果可以发现，就是根据 "),a("code",[s._v("packag.nls.json")]),s._v(" 生成了 "),a("code",[s._v("package.nls.[language].json")]),s._v(" 文件。")]),s._v(" "),a("h2",{attrs:{id:"参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[s._v("#")]),s._v(" 参考资料")]),s._v(" "),a("ol",[a("li",[a("code",[s._v("vscode-nls")]),s._v("："),a("a",{attrs:{href:"https://github.com/microsoft/vscode-nls",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/microsoft/vscode-nls"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("code",[s._v("vscode-nls-dev")]),s._v("： "),a("a",{attrs:{href:"https://github.com/microsoft/vscode-nls-dev",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/microsoft/vscode-nls-dev"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("code",[s._v("i18n-sample")]),s._v("："),a("a",{attrs:{href:"https://github.com/microsoft/vscode-extension-samples/tree/main/i18n-sample",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/microsoft/vscode-extension-samples/tree/main/i18n-sample"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=e.exports}}]);