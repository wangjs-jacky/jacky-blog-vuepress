(window.webpackJsonp=window.webpackJsonp||[]).push([[172],{578:function(s,t,a){"use strict";a.r(t);var n=a(19),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"example01-利用polynomialfeatures解决过拟合问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#example01-利用polynomialfeatures解决过拟合问题"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://nbviewer.jupyter.org/github/wangjs-jacky/Jupyter-notebook/blob/master/03_%E9%BB%84%E6%B0%B8%E6%98%8C_skleran%E5%9F%BA%E7%A1%800/ch05.01.ipynb",target:"_blank",rel:"noopener noreferrer"}},[s._v("Example01:利用PolynomialFeatures解决过拟合问题"),a("OutboundLink")],1)]),s._v(" "),a("ul",[a("li",[a("p",[s._v("线性回归模型实在是太简单了，非常容易导致欠拟合，根据前文中解决欠拟合的手段一共有两个：")]),s._v(" "),a("ul",[a("li",[s._v("增加物理特征，如房屋的地段，房屋的朝向等")]),s._v(" "),a("li",[s._v("增加无意义的数学变量。使用"),a("code",[s._v("sklearn.preprocessing.PolynomialFeatures")])])]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" sklearn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("linear_model "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" LinearRegression\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" sklearn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("preprocessing "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" PolynomialFeatures\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" sklearn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pipeline "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Pipeline\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("polynomial_model")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("degree"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    polynomial_features "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" PolynomialFeatures"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("degree"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("degree"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                                             include_bias"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    linear_regression "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" LinearRegression"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("normalize"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    pipeline "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Pipeline"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"polynomial_features"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" polynomial_features"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                         "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"linear_regression"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" linear_regression"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" pipeline\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("注：若是Pipeline中的若自己编写的函数，则默认调用的是"),a("code",[s._v(".fit_transform")]),s._v("方法，而最后的结点则必须要用"),a("code",[s._v(".fit()")]),s._v("实现。")])]),s._v(" "),a("li",[a("p",[s._v("使用"),a("code",[s._v("mean_squared_error")]),s._v("计算均方根误差")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" sklearn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("metrics "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" mean_squared_error\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20191225174259.png",alt:""}})])])]),s._v(" "),a("h1",{attrs:{id:"eample02-房价预测"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#eample02-房价预测"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://nbviewer.jupyter.org/github/wangjs-jacky/Jupyter-notebook/blob/master/03_%E9%BB%84%E6%B0%B8%E6%98%8C_skleran%E5%9F%BA%E7%A1%800/ch05.02.ipynb",target:"_blank",rel:"noopener noreferrer"}},[s._v("Eample02：房价预测"),a("OutboundLink")],1)]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" sklearn "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" datasets\nboston "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" datasets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("load_boston"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("return_X_y"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nX "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" boston"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("data\ny "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" boston"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("target\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者直接元组接受")]),s._v("\nX"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" y "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_boston"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("return_X_y"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20191225180524.png",alt:""}})])])}),[],!1,null,null,null);t.default=e.exports}}]);