(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{430:function(t,e,a){"use strict";a.r(e);var _=a(19),v=Object(_.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"_0-前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0-前言"}},[t._v("#")]),t._v(" 0.前言")]),t._v(" "),a("p",[t._v("本篇博客是状态管理杂谈，主观阅读记录。")]),t._v(" "),a("h2",{attrs:{id:"_1-状态管理方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-状态管理方式"}},[t._v("#")]),t._v(" 1.状态管理方式")]),t._v(" "),a("h3",{attrs:{id:"_1-1-react组件中的状态传递方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-react组件中的状态传递方式"}},[t._v("#")]),t._v(" 1.1 React组件中的状态传递方式")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("父子通信")])]),t._v(" "),a("li",[a("p",[t._v("子父通信")])]),t._v(" "),a("li",[a("p",[t._v("兄弟组件通信。")]),t._v(" "),a("center",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5732aadd10684db38c572b3b15181c3c~tplv-k3u1fbpfcp-watermark.awebp"}})])],1)]),t._v(" "),a("h3",{attrs:{id:"_1-2-使用context-api-维护全局状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-使用context-api-维护全局状态"}},[t._v("#")]),t._v(" 1.2 使用"),a("code",[t._v("Context API")]),t._v(" 维护全局状态")]),t._v(" "),a("p",[a("code",[t._v("Context API")]),t._v(" 有 "),a("strong",[t._v("3")]),t._v(" 个关键的要素："),a("code",[t._v("React.createContext")]),t._v("、"),a("code",[t._v("Provider")]),t._v("、"),a("code",[t._v("Consumer")]),t._v("。")]),t._v(" "),a("h3",{attrs:{id:"_1-3-redux-设计模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-redux-设计模式"}},[t._v("#")]),t._v(" 1.3 Redux 设计模式")]),t._v(" "),a("p",[t._v("历史："),a("code",[t._v("MVC")]),t._v(" "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mo",[t._v("→")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\rightarrow")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.36687em","vertical-align":"0em"}}),a("span",{staticClass:"mrel"},[t._v("→")])])])]),t._v(" "),a("code",[t._v("Flux")]),t._v(" "),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",[a("semantics",[a("mrow",[a("mo",[t._v("→")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\\rightarrow")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.36687em","vertical-align":"0em"}}),a("span",{staticClass:"mrel"},[t._v("→")])])])]),t._v(" "),a("code",[t._v("Redux")]),t._v(" (单向数据流)")]),t._v(" "),a("center",[a("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7bf55eead8e04787b854ec3cb73fab8b~tplv-k3u1fbpfcp-watermark.awebp"}})]),t._v(" "),a("h3",{attrs:{id:"_1-4-usereducer-hooks组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-usereducer-hooks组件"}},[t._v("#")]),t._v(" 1.4 useReducer（Hooks组件）")]),t._v(" "),a("p",[t._v("简易版 "),a("code",[t._v("Redux")]),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"_2-redux"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-redux"}},[t._v("#")]),t._v(" 2.Redux")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("优点：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("状态持久化（组件销毁了，"),a("code",[t._v("store")]),t._v("也还在）")])]),t._v(" "),a("li",[a("p",[t._v("状态可回溯（每次"),a("code",[t._v("action")]),t._v("，不会修改原有状态，总是返回新的状态）")])]),t._v(" "),a("li",[a("p",[t._v("纯函数：无任何副作用。副作用的含义，见下")]),t._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("b")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 副作用，不知道这里做了啥？")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" b\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("拥有大量优秀的第三方中间件插件，能够更精细地控制数据的流动，对复杂的业务场景起到了缓冲的作用。")])])])]),t._v(" "),a("li",[a("p",[t._v("缺点：")]),t._v(" "),a("ul",[a("li",[t._v("繁重的模板代码")]),t._v(" "),a("li",[a("code",[t._v("store")]),t._v("的状态残留，比如说，多个页面用到同一个数据源，在离开页面的时候使用初始化清空的问题。")]),t._v(" "),a("li",[t._v("无脑的发布订阅：每次 "),a("code",[t._v("dispatch")]),t._v(" 一个 "),a("code",[t._v("action")]),t._v(" 都会遍历所有的 "),a("code",[t._v("reducer")]),t._v("，重新计算 "),a("code",[t._v("connect")]),t._v("，这无疑是一种损耗；")]),t._v(" "),a("li",[t._v("交互频繁时会有卡顿：如果 "),a("code",[t._v("store")]),t._v(" 较大时，且频繁地修改 "),a("code",[t._v("store")]),t._v("，会明显看到页面卡顿。")]),t._v(" "),a("li",[t._v("时间回溯成本太高，每次都要更新引用，除非增加代码复杂度，或使用 "),a("code",[t._v("immutable")])]),t._v(" "),a("li",[t._v("不支持 "),a("code",[t._v("Typescript")]),t._v("。")])])])]),t._v(" "),a("h2",{attrs:{id:"_3-mobx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-mobx"}},[t._v("#")]),t._v(" 3. Mobx")]),t._v(" "),a("ul",[a("li",[t._v("与 "),a("code",[t._v("Redux")]),t._v(" 的区别，"),a("code",[t._v("Mobx")]),t._v(" 为响应式编程，编程风格基于传统的面向对象的范式。")]),t._v(" "),a("li",[t._v("具体的实现："),a("code",[t._v("Vue")]),t._v(" 是采用数据劫持的方式来达到监听的操作（"),a("code",[t._v("Object.defineProperty")]),t._v("的方式|"),a("code",[t._v("ES6 proxy")]),t._v("）"),a("code",[t._v("Redux")]),t._v("则是采用 "),a("code",[t._v("eventHub")]),t._v("。")]),t._v(" "),a("li",[a("code",[t._v("Vue")]),t._v("官网："),a("code",[t._v("React+Mobx = Vue")])]),t._v(" "),a("li",[t._v("优点：\n"),a("ul",[a("li",[t._v("代码量少")]),t._v(" "),a("li",[t._v("基于数据劫持实现，真正意义上的局部更新。")]),t._v(" "),a("li",[t._v("响应式性能良好")]),t._v(" "),a("li",[t._v("完全可以取代 "),a("code",[t._v("React")]),t._v(" 自身的状态管理。")]),t._v(" "),a("li",[t._v("支持 "),a("code",[t._v("Typescript")])])])]),t._v(" "),a("li",[t._v("比较："),a("code",[t._v("Redux")]),t._v(" | "),a("code",[t._v("Mobx")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("Redux")]),t._v("：背靠函数式，开源界标配")]),t._v(" "),a("li",[a("code",[t._v("Mobx")]),t._v("：面向对象，更关注对响应后的状态的处理，内部已经帮你实现了属性监听。")])])])]),t._v(" "),a("h2",{attrs:{id:"_4-观点摘抄"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-观点摘抄"}},[t._v("#")]),t._v(" 4.观点摘抄")]),t._v(" "),a("ol",[a("li",[a("p",[a("strong",[t._v("组件变得臃肿")]),t._v("。有的时候几个组件共用一个 "),a("code",[t._v("state")]),t._v("，这时候就不得不把这个 "),a("code",[t._v("state")]),t._v(" 提升到这几个组件的共同父级组件。在这种情况下，组件所持有的一些特定状态往往很不 "),a("code",[t._v("make sense")]),t._v("，而只是为了组件间通信而强行加上去，导致某些组件变得十分臃肿，在 "),a("code",[t._v("Class Component")]),t._v(" 中，可通过：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("Hoc")])]),t._v(" "),a("li",[a("code",[t._v("render props")])])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("redux")]),t._v(" 与 "),a("code",[t._v("Mobx")]),t._v(" 的分治思想："),a("code",[t._v("Redux")]),t._v(" 中可以分解 "),a("code",[t._v("reducer")]),t._v("，"),a("code",[t._v("Mobx")]),t._v(" 可以分解 "),a("code",[t._v("store")]),t._v("。")]),t._v(" "),a("center",[a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/1/4/16f6e3c25b8d4a92~tplv-t2oaga2asx-watermark.awebp"}})])],1)]),t._v(" "),a("h2",{attrs:{id:"_5-状态管理库记录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-状态管理库记录"}},[t._v("#")]),t._v(" 5.状态管理库记录")]),t._v(" "),a("ol",[a("li",[a("p",[a("code",[t._v("Jotai")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("dva")])]),t._v(" "),a("p",[t._v("看不懂，集成了"),a("code",[t._v("saga")]),t._v("，目前查到的最新评价对此都不是很正向，可能有很多我考虑不到的场景吧。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("Recoil")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("rematch")])]),t._v(" "),a("p",[t._v("写法很像"),a("code",[t._v("vuex")]),t._v("。")]),t._v(" "),a("p",[t._v("省略了："),a("code",[t._v("ActionType")]),t._v("，"),a("code",[t._v("ActionCreator")]),t._v(" (规范化"),a("code",[t._v("Action")]),t._v("创建的过程)，"),a("code",[t._v("switch")]),t._v(" 等。")])])]),t._v(" "),a("h2",{attrs:{id:"_6-未解决的问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-未解决的问题"}},[t._v("#")]),t._v(" 6.未解决的问题")]),t._v(" "),a("p",[t._v("在查找资料的过程中，发现了两个有趣的知识点，以前碰到过，之前没放心上，这里做个临时的记录。")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("使用 "),a("code",[t._v("StrictMode")]),t._v(" 时，开发环境下 "),a("code",[t._v("React")]),t._v(" 会故意渲染2次，以此触发潜在的副作用。")]),t._v(" "),a("p",[t._v("知乎地址：https://www.zhihu.com/question/387196401")])]),t._v(" "),a("li",[a("p",[t._v("跨域解决方案：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("proxy")]),t._v("怎么配：在"),a("code",[t._v("package.json")]),t._v("中加上 "),a("code",[t._v("proxy")]),t._v(" 代理配置。")]),t._v(" "),a("li",[a("code",[t._v("Creat-react-app")]),t._v(" 中使用了 "),a("code",[t._v("http-proxy-middleware")])]),t._v(" "),a("li",[a("code",[t._v("nginx")]),t._v("配置反向代理。")]),t._v(" "),a("li",[t._v("https://www.cnblogs.com/yy136/p/12674972.html")])])])]),t._v(" "),a("h2",{attrs:{id:"_7-参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-参考资料"}},[t._v("#")]),t._v(" 7.参考资料：")]),t._v(" "),a("ol",[a("li",[a("p",[a("a",{attrs:{href:"https://juejin.cn/post/6938207430048219166",target:"_blank",rel:"noopener noreferrer"}},[t._v("数据流管理方案：Redux 和 MobX 哪个更好？"),a("OutboundLink")],1),t._v("\n深度一般，但是总结还行。")])]),t._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/32245043",target:"_blank",rel:"noopener noreferrer"}},[t._v("facebook大佬：从前端状态管理，到响应式编程"),a("OutboundLink")],1)])]),t._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://juejin.cn/post/6844904022143434766",target:"_blank",rel:"noopener noreferrer"}},[t._v("Redux 包教包会系列"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("里面给出了具体的案例，有空一定要敲一敲，里面那个分解reducer的图实在是画的太清楚了。")])]),t._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://juejin.cn/post/6985517053390110728",target:"_blank",rel:"noopener noreferrer"}},[t._v("函数式编程、响应式编程、函数响应式编程"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("除了读不懂，其他写的都挺好的。")])]),t._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://www.cnblogs.com/greatluoluo/p/8469224.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("在react/redux中使用Immutable "),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("写的非常好，Immutable我也是第一次听说过。")])])])],1)}),[],!1,null,null,null);e.default=v.exports}}]);