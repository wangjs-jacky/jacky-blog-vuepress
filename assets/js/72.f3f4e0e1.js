(window.webpackJsonp=window.webpackJsonp||[]).push([[72],{479:function(s,e,n){"use strict";n.r(e);var a=n(19),t=Object(a.a)({},(function(){var s=this,e=s.$createElement,n=s._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"_0-前言"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_0-前言"}},[s._v("#")]),s._v(" 0.前言")]),s._v(" "),n("p",[s._v("一直搞不懂"),n("code",[s._v("npm link")]),s._v("的用作，这里做一个说明。")]),s._v(" "),n("blockquote",[n("p",[s._v("提前注："),n("code",[s._v("package.json")]),s._v(" 中定义的"),n("code",[s._v("packageName")]),s._v("应小写，不要采用驼峰命名。")])]),s._v(" "),n("h2",{attrs:{id:"_1-自定义-module-的使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-自定义-module-的使用"}},[s._v("#")]),s._v(" 1.自定义 "),n("code",[s._v("module")]),s._v(" 的使用")]),s._v(" "),n("p",[s._v("如果我们想自己开发一个依赖包，可以在多个项目中使用，标准的做法是：")]),s._v(" "),n("ol",[n("li",[s._v("将开发好的 "),n("code",[s._v("module")]),s._v(" 直接发布到 "),n("code",[s._v("npm")]),s._v(" 仓库上。")]),s._v(" "),n("li",[s._v("当其他项目中需要使用这个"),n("code",[s._v("module")]),s._v("时，直接在本地项目中执行 "),n("code",[s._v("npm install moduleNmae")]),s._v("。")])]),s._v(" "),n("p",[s._v("但是这样做存在一个问题，在每次修改 "),n("code",[s._v("module")]),s._v(" 源码后，需要重新发布到"),n("code",[s._v("npm")]),s._v("镜像仓库。")]),s._v(" "),n("p",[s._v("使用"),n("code",[s._v("npm link")]),s._v("命令可以简化 "),n("code",[s._v("module")]),s._v(" 修改后繁琐的"),n("code",[s._v("npm publish")]),s._v("和"),n("code",[s._v("npm update module")]),s._v("操作。")]),s._v(" "),n("h2",{attrs:{id:"_2-示例项目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-示例项目"}},[s._v("#")]),s._v(" 2.示例项目")]),s._v(" "),n("p",[s._v("示例代码地址："),n("a",{attrs:{href:"https://github.com/wangjs-jacky/npm_link.git",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/wangjs-jacky/npm_link.git"),n("OutboundLink")],1)]),s._v(" "),n("p",[s._v("项目结构如下：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n├── main          "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在项目中需要导入`module_name1`文件 ")]),s._v("\n│   └── demo.js\n└── module_name1  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 自定义的module文件")]),s._v("\n    ├── index.js\n    └── package.json\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("如果直接运行"),n("code",[s._v("node main/demo.js")]),s._v("，会报错误信息"),n("code",[s._v("“MODULE_NOT_FOUND”")]),s._v("。")]),s._v(" "),n("p",[s._v("在不使用将"),n("code",[s._v("module")]),s._v("推送到"),n("code",[s._v("npm")]),s._v("官方制品库的条件下，可以使用"),n("code",[s._v("npm link")]),s._v("解决上面的问题。")]),s._v(" "),n("p",[s._v("测试步骤如下：")]),s._v(" "),n("ol",[n("li",[n("p",[s._v("在"),n("code",[s._v("module_name1")]),s._v("文件夹下，执行")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("link")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mac需要开权限")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("执行后，会在全局的"),n("code",[s._v("node_modules")]),s._v("环境下会生成一个"),n("strong",[s._v("符号链接文件")]),s._v("，在"),n("code",[s._v("windows")]),s._v("下就是创建一个快捷方式文件。")]),s._v(" "),n("blockquote",[n("p",[s._v("这个操作就是替换："),n("code",[s._v("npm install -g 包名")])])])]),s._v(" "),n("li",[n("p",[s._v("在"),n("code",[s._v("main")]),s._v("文件夹下，执行")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("link")]),s._v(" 包名"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("module_name1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("执行后，将全局"),n("code",[s._v("node_modules")]),s._v("下刚创建的"),n("code",[s._v("module")]),s._v("安装到本地项目")]),s._v(" "),n("blockquote",[n("p",[s._v("这个操作就是替换："),n("code",[s._v("npm install --save 包名")])])])])]),s._v(" "),n("p",[s._v("执行后，原先项目的结构会发生变化，目录结构如下：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n├── main\n│   ├── demo.js\n│   └── + node_modules  \n│       └── + module_name1 -"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/usr/local/lib/node_modules/module_name1\n└── module_name1\n    ├── index.js\n    ├── + package-lock.json\n    └── package.json\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("p",[s._v("从上面可以发现，共增加了三个文件。")]),s._v(" "),n("p",[s._v("此时，再执行"),n("code",[s._v("node main/demo.js")]),s._v("，就可以正常打印出期望值，不会报错了。")]),s._v(" "),n("h2",{attrs:{id:"_3-卸载操作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-卸载操作"}},[s._v("#")]),s._v(" 3.卸载操作")]),s._v(" "),n("p",[s._v("在卸载阶段，"),n("code",[s._v("module_name1")]),s._v("和"),n("code",[s._v("main")]),s._v("执行的指令都是相同的：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" unlink 包名"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("module_name1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"_4-npm-install-g-和-s的区别"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-npm-install-g-和-s的区别"}},[s._v("#")]),s._v(" 4."),n("code",[s._v("npm install -g")]),s._v(" 和"),n("code",[s._v("-s")]),s._v("的区别")]),s._v(" "),n("p",[s._v("这个"),n("code",[s._v("DEMO")]),s._v("项目演示结束后，会突然冒出一个疑问，既然全局已经安装了"),n("code",[s._v("module")]),s._v("了，为什么在"),n("code",[s._v("main")]),s._v("文件夹下，仍然需要使用"),n("code",[s._v("npm link")]),s._v("再安装一遍呢？")]),s._v(" "),n("p",[s._v("这是因为：")]),s._v(" "),n("p",[n("code",[s._v("npm install -g moduleName")]),s._v("是将模块装到全局目录下，但是全局方式的安装是供命令行"),n("code",[s._v("(command line)")]),s._v("使用的，但是这种通过全局安装的模块"),n("code",[s._v("module")]),s._v("是无法在代码中使用"),n("code",[s._v("require")]),s._v("调用导入的，默认还是从本地的"),n("code",[s._v("node_modules")]),s._v("中寻找依赖。")]),s._v(" "),n("h2",{attrs:{id:"_5-参考博客"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-参考博客"}},[s._v("#")]),s._v(" 5.参考博客")]),s._v(" "),n("ol",[n("li",[n("a",{attrs:{href:"https://www.cnblogs.com/zhangzl419/p/15210835.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("博客园：npm link的用法"),n("OutboundLink")],1)])])])}),[],!1,null,null,null);e.default=t.exports}}]);